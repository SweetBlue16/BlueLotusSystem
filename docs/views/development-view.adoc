== Vista de implementación

=== Propósito de la vista


=== Justificación de las decisiones


=== Diagramas de Especificación de Componentes
Los diagramas de especificación de componentes se utilizan para describir la estructura y organización de los componentes del sistema. Estos diagramas muestran cómo se dividen las funcionalidades en diferentes componentes y cómo se relacionan entre sí. Se centran en los aspectos técnicos de la implementación, como las interfaces de los componentes, sus dependencias y la forma en que interactúan.

A continuación, se presentan los diagramas de especificación de componentes del sistema:

==== Diagrama de Especificación de Componentes del Módulo de Auditoría
image::../images/AuditModuleComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes del Módulo de Auditoría"]

==== Diagrama de Especificación de Componentes del Módulo de Inventario
image::../images/InventoryManagerComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes del Módulo de Inventario"]

==== Diagrama de Especificación de Componentes del Módulo de Pagos
image::../images/PaymentManagerComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes del Módulo de Pagos"]

==== Diagrama de Especificación de Componentes de la Pasarela de Pagos
image::../images/PaymentServiceComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes de la Pasarela de Pagos"]

==== Diagrama de Especificación de Componentes del Módulo de Reportes
image::../images/ReportManagerComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes del Módulo de Reportes"]

==== Diagrama de Especificación de Componentes del Módulo de Reservaciones
image::../images/ReservationManagerComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes del Módulo de Reservaciones"]

==== Diagrama de Especificación de Componentes del Módulo de Estancias
image::../images/StaysManagerComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes del Módulo de Estancias"]

==== Diagrama de Especificación de Componentes del Módulo de Usuarios
image::../images/UserManagerComponent.png[width=600,align="center",alt="Diagrama de Especificación de Componentes del Módulo de Usuarios"]


=== Diagramas de Especificación de Interfaces
Los diagramas de especificación de interfaces se utilizan para definir las interfaces que los componentes del sistema exponen y consumen. Estos diagramas detallan los métodos, atributos y protocolos de comunicación que permiten la interacción entre diferentes componentes. Se centran en cómo los componentes se comunican entre sí a través de sus interfaces, asegurando una integración efectiva y coherente.

A continuación, se presentan los diagramas de especificación de interfaces del sistema:

==== Diagrama de Especificación de Interfaces de IAuditoría
image::../images/IAuditoriaSpecification.bmp[width=600,align="center",alt="Diagrama de Especificación de Interfaces de IAuditoría"]

==== Especificación de las Operaciones de IAuditoría
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
|===

==== Diagrama de Especificación de Interfaces de IAutenticación
image::../images/IAutenticaciónSpecification.png[width=600,align="center",alt="Diagrama de Especificación de Interfaces de IAutenticación"]

==== Especificación de las Operaciones de IAutenticación
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| iniciarSesion() |
- Los datos en credenciales son formalmente válidos
|
**Caso Éxito:** +
- Las credenciales.identificador y credenciales.contrasena coinciden con un usuario registrado y activo en el sistema. +
- El valor de retorno indica éxito (exito = true). +
- El resultado.usuarioInfo contiene los datos del usuario autenticado. +
- Se genera un tokenSesion único y con tiempo de expiracionToken definido, que se incluye en resultado.usuarioInfo. +
- Se registra el intento de inicio de sesión exitoso. +
**Caso Fallo (Credenciales Inválidas):** +
- Las credenciales.identificador y credenciales.contrasena no coinciden con un usuario registrado y activo. +
- El valor de retorn indica fallo (exito = false). +
- El resultado.mensajeError indica "Credenciales inválidas" o un mensaje similar genérico. +
- resultado.usuarioInfo es nulo o indefinido. +
**Caso Fallo (Usuario Inactivo/Bloqueado):** +
- Las credenciales coinciden, pero la cuenta del usuario está inactiva o bloqueada. +
- El valor de retorno indica fallo (exito = false). +
- El resultado.mensajeError indica "Cuenta inactiva" o "Cuenta bloqueada". +
- resultado.usuarioInfo es nulo o indefinido. +
- Se registra el intento de inicio de sesión fallido.
|===

==== Diagrama de Especificación de Interfaces de ICheckIn
image::../images/ICheckInSpecification.bmp[width=600,align="center",alt="Diagrama de Especificación de Interfaces de ICheckIn"]

==== Especificación de las Operaciones de ICheckIn
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| realizarCheckIn() |
- Existe una ReservacionInfoCheckIn con el idReservacion proporcionado. +
- La fecha actual está dentro del rango permitido para el check-in de la reservación. +
- El estado de la reservación permite el check-in. +
- Existe al menos una HabitacionInfo disponible en el hotel y del tipo especificados en la reservación.
|
- Se identifica o crea una instancia de EstanciaInfo asociada a la reservación. +
- Se selecciona una HabitacionInfo que cumple las condiciones. +
- El estado de la habitación seleccionada se actualiza a 'Ocupada'. +
- La estancia se actualiza o crea con: +
* **estancia.habitacionAsignada = hab** +
* **estancia.fechaCheckIn = fecha/hora actual** +
* **estancia.fechaCheckOutPrevista = res.fechaFin** +
* **estancia.estado = 'Activa'** +
* **estancia.huesped = res.huesped** +
- El estado de la reservación res se actualiza para reflejar que el check-in ocurrió. +
- El valor de retorno (ResultadoCheckIn) indica éxito, contiene el idEstancia y el numeroHabitacionAsignada. +
- Si alguna precondición falla, el valor de retorno indica fallo y mensajeError detalla la causa. El estado del sistema no cambia.

|===

==== Diagrama de Especificación de Interfaces ICheckOut
image::../images/ICheckOutSpecification.png[width=600,align="center",alt="Diagrama de Especificación de Interfaces ICheckOut"]

==== Especificación de las Operaciones de ICheckOut
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
|===

==== Diagrama de Especificación de Interfaces IConsultaDisponibilidad
image::../images/IConsultaDisponibilidadSpecification.bmp[width=600,align="center",alt="Diagrama de Especificación de Interfaces IConsultaDisponibilidad"]

==== Especificación de las Operaciones de IConsultaDisponibilidad
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| consultarDisponibilidad() |
- Las fechas en consulta son válidas (fechaInicio < fechaFin, fechaInicio >= fecha actual). +
- Si se especifica consulta.idHotel, el hotel debe existir y estar activo. +
- Si se especifica consulta.idTipoHabitacion, este debe existir y pertenecer al idHotel (si se especificó hotel). +
- Si se especifica consulta.numeroHuespedes, este debe ser un entero positivo.
|
- Se retorna una lista (list<DisponibilidadResultado>) que contiene una entrada por cada combinación de HotelInfoConsulta y TipoHabitacionInfoConsulta que cumple con los criterios de la consulta y tiene disponibilidad en al menos una parte del rango consulta.fechaInicio a consulta.fechaFin. +
- Cada DisponibilidadResultado en la lista contiene: +
  * La **información** del hotel y tipo de habitación. +
  * **fechasDisponibles:** Una lista de rangos de fechas dentro del rango consultado donde sí hay disponibilidad. Si hay disponibilidad continua en todo el rango, esta lista contendrá un solo DateRange igual al consultado. +
  * **tarifaPromedioNoche:** El precio promedio por noche calculado para ese tipo de habitación en las fechas consultadas. +
  * **numeroHabitacionesDisponibles:** El número estimado de habitaciones disponibles (puede ser > número físico si hay overbooking). +
- Si consulta.numeroHuespedes fue especificado, solo se incluyen resultados donde TipoHabitacionInfoConsulta.capacidadMaxima >= consulta.numeroHuespedes. +
- Si no se encuentra ninguna disponibilidad que coincida con los criterios, se retorna una lista vacía. +
- El estado del sistema no cambia.
|===

==== Diagrama de Especificación de Interfaces IGestionEstancias
image::../images/IGestionEstanciaSpecification.bmp[width=600,align="center",alt="Diagrama de Especificación de Interfaces IGestionEstancias"]

==== Especificación de las Operaciones de IGestionEstancias
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| cambiarHabitacion() |
- Existe una EstanciaInfoGestion con el idEstancia proporcionado y está 'Activa'. +
- Existe una HabitacionInfoGestion con idNuevaHabitacion en el mismo hotel (estancia.habitacionAsignada.hotel). +
- La nueva habitación está actualmente 'Disponible' (habNueva.estadoActual = 'Disponible'). +
- La habitación actual asignada a la estancia (habActual = estancia.habitacionAsignada) existe y está 'Ocupada'.
|
- El estado de la habitación actual se cambia a 'Disponible' (o 'Limpieza Pendiente'). +
- El estado de la nueva habitación se cambia a 'Ocupada'. +
- La estancia se actualiza para referenciar a la nueva habitación: estancia.habitacionAsignada = habNueva. +
- Se calcula un ajusteCosto si habNueva.tipoHabitacion tiene una tarifa diferente a habActual.tipoHabitacion para las noches restantes. Este ajuste se suma (o resta) a estancia.saldoPendiente. +
- El valor de retorno indica éxito (exito = true), contiene el nuevoNumeroHabitacion (habNueva.numeroHabitacion) y el ajusteCosto calculado. +
- Si alguna precondición falla, el valor de retorno indica fallo (exito = false) y mensajeError explica por qué. El estado del sistema no cambia.
| extenderEstancia() |
- Existe una EstanciaInfoGestion con el idEstancia proporcionado y está 'Activa'. +
- La nuevaFechaFin es posterior a la estancia.fechaCheckOutPrevista actual. +
- La habitación actualmente asignada (habActual = estancia.habitacionAsignada) está disponible (no tiene otras reservas conflictivas) entre estancia.fechaCheckOutPrevista (exclusivo) y nuevaFechaFin (inclusivo). +
|
- La fecha de salida prevista de la estancia se actualiza: estancia.fechaCheckOutPrevista = nuevaFechaFin. +
- Se recalcula el costo total de la estancia (basado en las tarifas diarias del habActual.tipoHabitacion para las noches añadidas) y se actualiza estancia.saldoPendiente con la diferencia. +
-El valor de retorno indica éxito (exito = true), la nuevaFechaFin y el nuevoCostoTotal recalculado de la estancia. +
- Si alguna precondición falla, el valor de retorno indica fallo (exito = false) y mensajeError lo explica. El estado de la estancia no cambia.
| registrarConsumo() |
- Existe una EstanciaInfoGestion con el idEstancia proporcionado y está 'Activa'. +
- El producto o servicio identificado por detalleConsumo.idProductoServicio existe en el catálogo y tiene un precio definido. +
- La detalleConsumo.cantidad es un número positivo.
|
- Se crea un nuevo registro de ConsumoInfo asociado a la estancia. +
- nuevoConsumo contiene los detalles proporcionados (idProductoServicio, cantidad, notas). +
- Se calcula nuevoConsumo.costoTotal (cantidad * costo unitario del producto/servicio).  +
- nuevoConsumo.fechaRegistro se establece a la fecha/hora actual. +
- El estancia.saldoPendiente se incrementa por el nuevoConsumo.costoTotal. +
- El valor de retorno  indica éxito (exito = true), el idConsumoRegistrado y el costoConsumo. +
- Si alguna precondición falla, el valor de retorno indica fallo (exito = false) y mensajeError lo detalla. El saldoPendiente de la estancia no cambia.
|===

==== Diagrama de Especificación de Interfaces IInventario
image::../images/IInventarioSpecification.png[width=600,align="center",alt="Diagrama de Especificación de Interfaces IInventario"]

==== Especificación de las Operaciones de IInventario
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| agregarHotel() |
- datosHotel contiene datos válidos. +
- No existe un HotelInfoInventario con el mismo nombre y dirección.
|
- Se crea una nueva instancia de HotelInfoInventario. +
- nuevoHotel se rellena con los datos de datosHotel. +
- Se genera y se asigna un idHotel único a nuevoHotel. +
- nuevoHotel.estado se establece en "disponible". +
- El valor de retorno (ResultadoHotel) indica éxito y contiene el idHotel de nuevoHotel. +
- Si falla una precondición, el valor de retorno indica fallo con mensajeError. No se crear el hotel.
| crearTipoHabitación() |
- Existe un HotelInfoInventario con idHotel. +
- datosTipo contiene datos válidos.
|
- Se crea una nueva instancia de TipoHabitaciónInfoInventario. +
- nuevoTipo se rellena con los datos de datosTipo. +
- Se genera y asigna un idTipoHabitacion único a nuevoTipo.idTipoHabitacion. +
- nuevoTipo se asocia con el hotel especificado. +
- El valor de retorno (ResultadoTipoHabitacion) indica éxito y contiene el nuevo idTipoHabitacion. +
- Si falla una precondición, el valor de retorno indica fallo con mensajeError. No se crea el tipo.
| registrarHabitación() |
- Existe un HotelInfoInventario con el idHotel dado. +
- Existe un TipoHabitacionInfoInventario con el idTipoHabitacion dado y pertenece a hotel. +
- datosHabitacion contiene datos válidos. +
- No existe ya una HabitacionInfoInventario dentro de hotel con el mismo numeroHabitacion.
|
- Se crea una nueva instancia de HabitacionInfoInventario. +
- nuevaHab se rellena con los datos de datosHabitacion. +
- Se genera y asigna un idHabitacion único a nuevaHab.idHabitacion. +
- nuevaHab se asocia con el hotel y tipo especificados. +
- nuevaHab.estado se establece a 'Disponible' (estado por defecto). +
- El valor de retorno (ResultadoHabitacion) indica éxito y contiene el nuevo idHabitacion. +
- Si falla una precondición, el valor de retorno indica fallo con mensajeError. No se crea la habitación.
| cambiarEstadoHabitación() |
- Existe una HabitacionInfoInventario con el idHabitacion dado. +
- nuevoEstado es un estado válido de la lista definida.
|
- El estado de la habitación se actualiza: hab.estado = nuevoEstado. +
- El valor de retorno (ResultadoOperacion) indica éxito. +
- Si falla una precondición, el valor de retorno indica fallo con mensajeError. El estado no cambia.
| modificarHotel() |
- Existe un HotelInfoInventario con el idHotel proporcionado. +
- Los datos en datosHotel son válidos. +
- Si se cambia el nombre, este no debe entrar en conflicto con otro hotel en la misma ciudad.
|
- Los atributos del hotel se actualizan con los valores proporcionados in datosHotel. +
- El valor de retorno (ResultadoOperacion) indica éxito. +
- Si falla una precondición, el valor de retorno indica fallo con mensajeError. El estado del hotel no cambia.
| obtenerHotel() |
- Existe un HotelInfoInventario con el idHotel proporcionado. +
|
- Se retorna la instancia completa de HotelInfoInventario correspondiente al idHotel. +
- El estado del sistema no cambia. +
| listarHoteles() |
N/A
|
- Se retorna una lista (list<HotelInfoInventario>) con todos los hoteles del sistema. +
- Si no hay hoteles, se retorna una lista vacía. +
- El estado del sistema no cambia.
| modificarTipoHabitación() |
- Existe un TipoHabitacionInfoInventario con el idTipoHabitacion proporcionado. +
- Los datos en datosTipo son válidos.
|
- Los atributos del tipo se actualizan con los valores de datosTipo. +
- El valor de retorno (ResultadoOperacion) indica éxito. +
- Si falla una precondición, el valor de retorno indica fallo con mensajeError. El estado del tipo no cambia.
| obtenerTipoHabitación() |
- Existe un TipoHabitacionInfoInventario con el idTipoHabitacion proporcionado.
|
- Se retorna la instancia completa de TipoHabitacionInfoInventario. +
- El estado del sistema no cambia.
| listarTiposHabitaciónPorHotel() |
- Existe un HotelInfoInventario con el idHotel proporcionado.
|
- Se retorna una lista (list<TipoHabitacionInfoInventario>) con todos los tipos de habitación asociados al hotel.
- Si el hotel no tiene tipos de habitación definidos, se retorna una lista vacía. +
- El estado del sistema no cambia. +
| modificarHabitación() |
- Existe una HabitacionInfoInventario con el idHabitacion proporcionado. +
- Los datos en datosHabitacion son válidos.
|
- Los atributos de la hab se actualizan con los valores de datosHabitacion. +
- El valor de retorno (ResultadoOperacion) indica éxito. +
- Si falla una precondición, el valor de retorno indica fallo con mensajeError. El estado de la habitación no cambia.
| obtenerHabitación() |
- Existe una HabitacionInfoInventario con el idHabitacion proporcionado.
|
- Se retorna la instancia completa de HabitacionInfoInventario. +
- El estado del sistema no cambia.
| listarHabitacionesPorHotel() |
- Existe un HotelInfoInventario con el idHotel proporcionado.
|
- Se retorna una lista (list<HabitacionInfoInventario>) con todas las habitaciones asociadas al hotel. +
- Si el hotel no tiene habitaciones registradas, se retorna una lista vacía. +
- El estado del sistema no cambia.
|===

==== Diagrama de Especificación de Interfaces de IPago
image::../images/IPagoSpecification.png[width=600,align="center",alt="Diagrama de Especificación de Interfaces IPago"]

==== Especificación de las Operaciones de IPago
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
|===

==== Diagrama de Especificación de Interfaces IPasarelaPago
image::../images/IPasarelaPagoSpecification.bmp[width=600,align="center",alt="Diagrama de Especificación de Interfaces IPasarelaPago"]

==== Especificación de las Operaciones de IPasarelaPago
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| autorizarPago() |
- Los datos en solicitud son válidos según los requisitos del gateway.
|
- Se recibe una RespuestaAutorizacion. +
**Si respuesta.exitoInicio es true:** +
- El gateway ha aceptado la solicitud para procesarla. +
- Se recibe un idTransaccionExterna único del gateway. +
- Se recibe un estadoInicial ("PENDING", "REDIRECT_REQUIRED", etc.). +
- Si estadoInicial es "REDIRECT_REQUIRED", urlRedireccionUsuario contiene la URL a la que se debe redirigir al cliente. +
**Si respuesta.exitoInicio es false:** +
- El gateway rechazó la solicitud inicial. +
- Mensaje contiene la razón del fallo. idTransaccionExterna puede ser nulo. +
- Sistema usa respuestas para actualizar su PagoInfo interno.
| consultarEstadoTransaccion() |
- idTransaccionExterna es un ID válido previamente devuelto por el gateway en una RespuestaAutorizacion.
|
- Se recibe un EstadoTransaccionExterna. +
- respuesta.estado refleja el estado actual en el gateway ("COMPLETED", "FAILED", "PENDING", etc.). +
- Otros campos contienen detalles relevantes del estado actual según la definición del gateway. +
- Sistema usa la respuesta para actualizar el estado de su PagoInfo interno correspondiente.
| reembolsarPago() |
- solicitud.idTransaccionOriginal corresponde a una transacción completada ("COMPLETED") en el gateway. +
- solicitud.montoReembolsar es positivo y no mayor al monto original pagado. +
- El motivo es proporcionado si es requerido por el gateway.
|
- Se recibe una RespuestaReembolso. +
**Si respuesta.exito es true:** +
- El gateway ha procesado o iniciado el proceso de reembolso. +
- Se recibe un idTransaccionReembolso. +
- Se recibe un estadoReembolso ("PROCESSING", "COMPLETED", etc.). +
**Si respuesta.exito es false:** +
- El gateway rechazó la solicitud de reembolso. +
- mensaje contiene la razón del fallo. +
- Sistema usa esta respuesta para actualizar el PagoInfo interno o crear uno nuevo para el reembolso.
|===

==== Diagrama de Especificación de Interfaces IRegistro
image::../images/IRegistroSpecification.png[width=600,align="center",alt="Diagrama de Especificación de Interfaces IRegistro"]

==== Especificación de las Operaciones de IRegistro
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| registrarNuevoHuesped() |
- Los datos en datosNuevoHuesped son válidos.
- El email proporcionado en datosNuevoHuesped.email no está asociado a ninguna cuenta de HuespedInfoRegistro existente en el sistema.
|
- Se ha creado una nueva instancia de HuespedInfoRegistro asociada a esta interfaz.
- nuevoHuesped tiene los datos proporcionados.
- nuevoHuesped.fechaRegistro se establece a la fecha/hora actual.
- Se genera y asigna un idCliente único a nuevoHuesped.idCliente.
- Se crea un registro de credenciales seguro asociado al nuevoHuesped.idCliente usando datosNuevoHuesped.password.
- El valor de retorno (ResultadoRegistro) indica éxito y contiene el idCliente del nuevo huésped.
- Si la precondición del email único falla, el valor de retorno indica fallo y mensajeError explica la causa.
|===

==== Diagrama de Especificación de Interfaces IReporteAuditoría
image::../images/IReporteAuditoríaSpecification.png[width=600,align="center",alt="Diagrama de Especificación de Interfaces IReporteAuditoría"]

==== Especificación de las Operaciones de IReporteAuditoría
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
|===

==== Diagrama de Especificación de Interfaces IReporteFinanciero
image::../images/IReporteFinancieroSpecification.bmp[width=600,align="center",alt="Diagrama de Especificación de Interfaces IReporteFinanciero"]

==== Especificación de las Operaciones de IReporteFinanciero
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| generarReporteIngresosPorPeriodo() |
- El usuario que invoca la operación tiene permisos para generar reportes financieros. +
- Los criterios en filtro son válidos (fechaInicio <= fechaFin). +
- Si se especifica filtro.idHotel, este debe existir.
|
- Se consultan los datos relevantes (pagos, reservaciones completadas, estancias finalizadas, consumos registrados) de las interfaces correspondientes (IPago, IReservacion, IEstancia, etc.) que caen dentro del rango de fechas y hotel especificados en filtro. +
- Se construye un objeto ReporteFinancieroGenerado. +
- reporte.titulo se establece adecuadamente. +
- reporte.fechaGeneracion es la fecha/hora actual. +
- reporte.periodo describe el rango filtro.fechaInicio a filtro.fechaFin. +
- reporte.hotel indica el ID o nombre del hotel si se filtró por uno, o "Toda la cadena" si no. +
- reporte.filtrosAplicados describe los criterios usados. +
- Se calcula y rellena reporte.resumenIngresos agregando los montos de las transacciones consultadas (separando alojamiento de consumos). +
- Se retorna el reporte generado. +
- El estado del sistema no cambia.
|===

==== Diagrama de Especificación de Interfaces IReservación
image::../images/IReservaciónSpecification.png[width=600,align="center",alt="Diagrama de Especificación de Interfaces IReservación"]

==== Especificación de las Operaciones de IReservación
[cols="^20,<40,<40", options="header"]
|===
| Operación | Precondiciones | Postcondiciones
| crearReservacion() |
- Existe y está activo un HotelInfo con el idHotel dado. +
- Existe el TipoHabitacionInfo con el idTipoHabitacion dado y pertence al idHotel especificado. +
- La fechaCreacion y fechaFin de la ReservacionInfo es válida (fechaCreacion < fechaFin, fechaInicio >= fecha actual). +
- Hay disponibilidad para idTipoHabitacion en el idHotel durante el rango de fechas especificado (considerando políticas de overbooking). +
- Si se proporciona detallesCli.idCliente, este debe corresponder a un cliente existente. +
- Si no se proporciona detallesCli.idCliente, se deben incluir nombre, email y postCode válidos para crear un cliente nuevo.
|
- Se crea una nueva instancia de ReservacionInfo. +
- nuevaRes contiene todos los datos proporcionados. +
- El estado de nuevaRes se establece como 'Pendiente'. +
- El costoTotal de las nuevaRes se calcula y establece en las tarifas vigentes de las fechas y el tipo de habitación. +
- La fechaCreacion de la nuevaRes queda estblecida con la fecha/hora actual. +
- El valor de retorno de ReultadoReservacion indica éxito, conteniendo el idReservacion de la nuevaRes y el costoCalculado.
|cancelarReservacion()|
- Existe un ReservacionInfo con el idReservacion proporcionado. +
- La reservación asociada a idReservacion está en un estado cancelable. No se puede cancelar si está 'Completada', 'Ocupada' o ya 'Cancelada'.
|
- El estado de la reservació se actualiza a 'Cancelada'. +
- Se calcula la penalizacionAplicada según las políticas de cancelación. +
- El valor de retorno (ResultadoCancelacion) indica éxito (exito = true), incluye un mensaje informativo y el monto de penalizacionAplicada.
| obtenerDetallesReservacion()|
- Existe una ReservacionInfo con el idReservacion proporcionado.
|
- Se retorna la instancia completa de ReservacionInfo correspondiente al idReservacion. +
- El estado del sistema no cambia.
| modificarReservacion() |
- Existe una ReservacionInfo con el idReservacion proporcionado. +
- La reservación está en un estado modificable. +
- Las nuevas fechas en nuevosDetalles son válidas (inicio < fin, inicio >= fecha actual). +
- El nuevo hotel (nuevosDetalles.idHotel) existe. +
- El nuevo tipo de habitación (nuevosDetalles.idTipoHabitacion) existe en ese hotel. +
- Hay disponibilidad para el nuevosDetalles.idTipoHabitacion en el nuevosDetalles.idHotel durante el nuevo rango de fechas (considerando overbooking y liberando la disponibilidad anterior).
|
- Los atributos de la reservación se actualizan con los valores de nuevosDetalles (fechas, tipo de habitación). +
- Se recalcula y actualiza res.costoTotal basado en las nuevas condiciones y tarifas. +
- El valor de retorno (ResultadoModificacion) indica éxito (exito = true) y el nuevoCosto.
|===


=== Interacción de Componentes

